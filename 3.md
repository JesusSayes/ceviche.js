# Capítulo 3: DOM y CSSOM

> Luego de haber visto las bases del lenguaje, es momento de conocer más del navegador y aprender a crear y modificar la interfaz de usuario. Existen dos APIs en el navegador que permiten manipular la estructura, contenido y presentación visual de lo que se muestra dentro de un navegador: el Document Object Model, o DOM, y el Cascade Style Sheet Object Model, o CSSOM.

## DOM

El Document Object Model, o DOM, es una API para documentos HTML que representa cada elemento de una página web en forma de objetos, permitiendo su manipulación para cambiar tanto la estructura como presentación visual. De igual forma, permite manejar eventos del usuario dentro del navegador.

### HTML

HyperText Markup Language, o HTML, es un lenguaje de marcado que permite definir la estructura y contenido de un documento mediante el uso de etiquetas. El proceso de convertir un documento en HTML en una estructura visual se llama **renderizar** y es el **motor de renderizado** el encargado de realizar esta acción.

Es el motor de renderizado el que, a su vez, se encarga de utilizar las hojas de estilo en cascada (CSS) para darle la presentación adecuada al documento HTML que se está renderizando. Los motores de renderizado más populares actualmente son:

* Webkit, utilizado en Safari y Chrome hasta su versión 27.
* Gecko, utilizado por Firefox y los productos de la Fundación Mozilla.
* Blink (*fork* de Webkit), utilizado actualmente por Chrome a partir de su versión 28.
* Presto, utilizado por Opera, que luego pasó a utilizar Blink.
* Trident, utilizado principalmente por Internet Explorer y otros productos de Microsoft.

### Nodos vs Elementos

La abstracción que el DOM realiza de un documento HTML utiliza el concepto de árbol de nodos para representar la estructura de elementos anidados que tiene el documento. Esto quiere decir que un elemento (o nodo en el árbol) puede tener elementos anidados dentro del mismo (nodos hijos); al tener nodos hijos, este elemento automáticamente se convierte en un nodo padre. El primer nodo de un árbol, es decir, aquel que tenga nodos hijos pero no es hijo de ningún otro nodo, es llamado **nodo raíz**.

Según la tabla de valores de la propiedad `nodeType` (ver [Apéndice A](a.md)), se pueden ver diferentes tipos de nodos. Al ser el DOM una abstracción basada en árboles de nodos, cada dato dentro de un documento HTML debe pertenecer a un tipo de nodo. Por ejemplo:

```html
<!DOCTYPE html>
<html>
<head>
  <title></title>
</head>
<body>
  <div class="emtpy-div"></div>
  <!-- Comentario dentro de un documento HTML -->
  Contenido de texto
</body>
</html>
```

| `nodeType` | Tipo de dato en HTML |
|------------|----------------------|
| `ELEMENT_NODE` | Elemento (`<div class="emtpy-div"></div>`) |
| `ATTRIBUTE_NODE` | Atributo (`class="emtpy-div"`) |
| `TEXT_NODE` | Texto (`Contenido de texto`) |
| `COMMENT_NODE` | Comentario (`<!-- Comentario dentro de un documento HTML -->`) |
| `DOCUMENT_NODE` | Documento (`window.document`) |
| `DOCUMENT_TYPE_NODE` | Doctype (`<!DOCTYPE html>`) |

Uno de estos tipos de nodos es el elemento (`ELEMENT_NODE`), el cual es la representación para toda etiqueta en un documento HTML. Esto quiere decir que todos los elementos son nodos, pero no todos los nodos son elementos.

### Lista "viva"

Una lista "viva" es una lista de elementos que automáticamente actualiza su contenido cuando estos cambian en otra parte del programa. Es decir, tanto si se agrega un elemento que concuerde con la lista o si se elimina un elemento que se encuentre en la lista, esta se actualizará con los elementos nuevos o quitando los eliminados posteriormente.

---

### `document`

`document` es el objeto que representa al nodo raíz de un documento HTML, y tiene acceso a los nodos que representan a las etiquetas `<head>` y `<body>`. Los iframes tienen su propio documento HTML, por lo que, si un documento tiene iframes, cada elemento `iframe` puede acceder a su propio documento mediante la propiedad `contentDocument`.

Entre los atributos que tiene un objeto `document` se encuentran:

#### `documentElement`

Devuelve un elemento que representa a la etiqueta `html`.

#### `title`

Devuelve el contenido de la etiqueta `<title></title>`, o uno asignado manualmente.

#### `head`

Devuelve un elemento que representa a la etiqueta `head`.

#### `body`

Devuelve un elemento que representa a la etiqueta `body`.

#### `styleSheets`

Devuelve una lista instancia de `StyleSheetList` con objetos `CSSStyleSheet`, uno por cada hoja de estilos definida (con `<style></style>`) o enlazada al documento (con `<link />`).

#### `cookie`

Devuelve una cadena con todas las cookies asignadas al documento actual.

#### `location`

Devuelve un objeto `Location`, el cual contiene información sobre la URL actual del documento. Esta propiedad puede ser cambiada, asignando una cadena con la nueva URL a la cual el navegador direccionará.

---

`document` también tiene algunas propiedades de la interfaz `Element`, como `children`, `firstElementChild `, `lastElementChild ` y `childElementCount`.

Así mismo, tiene métodos que sirven para crear elementos, y acceder a cualquier elemento dentro del documento:

#### `createAttribute`

Crea un nodo atributo (instancia de `Attr`) con un nombre pasado como parámetro.

#### `createComment`

Crea un nodo comentario con el contenido pasado como parámetro.

#### `createElement`

Crea un nodo elemento con el nombre de la etiqueta pasado como parámetro.

#### `createTextNode`

Crea un nodo texto con el contenido pasado como parámetro.

## CSSOM

El Cascade Style Sheet Object Model, o CSSOM, toma los conceptos de DOM y los lleva a las hojas de estilo en cascada que componen un documento HTML. Esto permite tener un control más profundo de las reglas y propiedades que se aplican tanto a un elemento como a un documento HTML, utilizando JavaScript.
